from aiogram import Router
from aiogram.filters import Command
from aiogram.types import Message

from config.settings import settings


router = Router()


# –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
__all__ = ["get_user_commands", "get_admin_commands"]


def get_user_commands() -> str:
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥."""
    return """üìã <b>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã:</b>

üöÄ <b>/start</b> - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
‚ùì <b>/help</b> - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
üìä <b>/my_votes</b> - –ü—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö –≥–æ–ª–æ—Å–æ–≤ –≤ –æ–ø—Ä–æ—Å–∞—Ö
üìÖ <b>/schedule</b> - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Å–º–µ–Ω"""


def get_admin_commands() -> str:
    """–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥."""
    return """üëë <b>–ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã:</b>

‚ûï <b>/add_group</b> - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É
   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /add_group –Ω–∞–∑–≤–∞–Ω–∏–µ chat_id [topic_id]
   –ü—Ä–∏–º–µ—Ä: /add_group –ó–ò–ó-1 -1001234567890 123
   topic_id - –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, ID —Ç–µ–º—ã –¥–ª—è —Ñ–æ—Ä—É–º-–≥—Ä—É–ø–ø

‚öôÔ∏è <b>/setup_ziz</b> - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–ª–æ—Ç—ã –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≥—Ä—É–ø–ø—ã
   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /setup_ziz –ó–ò–ó-1
   –ó–∞—Ç–µ–º –≤–≤–µ–¥–∏—Ç–µ —Å–ª–æ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ: –≤—Ä–µ–º—è_–Ω–∞—á–∞–ª–∞-–≤—Ä–µ–º—è_–∫–æ–Ω—Ü–∞:–ª–∏–º–∏—Ç

üìã <b>/list_groups</b> - –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥—Ä—É–ø–ø

üìä <b>/stats</b> - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–∏—Å—Ç–µ–º—ã

üìù <b>/create_polls</b> - –°–æ–∑–¥–∞—Ç—å –æ–ø—Ä–æ—Å—ã –≤—Ä—É—á–Ω—É—é (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

üìÑ <b>/get_report</b> - –ü–æ–ª—É—á–∏—Ç—å –æ—Ç—á–µ—Ç –ø–æ –≥—Ä—É–ø–ø–µ
   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /get_report –ó–ò–ó-1 [–¥–∞—Ç–∞]
   –î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ–≥–æ–¥–Ω—è)

üìë <b>/generate_all_reports</b> - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç—ã –¥–ª—è –≤—Å–µ—Ö –≥—Ä—É–ø–ø

üìå <b>/set_topic</b> - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å topic_id –¥–ª—è –≥—Ä—É–ø–ø—ã
   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /set_topic –Ω–∞–∑–≤–∞–Ω–∏–µ_–≥—Ä—É–ø–ø—ã topic_id
   –ü—Ä–∏–º–µ—Ä: /set_topic –ó–ò–ó-1 123

üîç <b>/status</b> - –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

üìú <b>/logs</b> - –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã"""


@router.message(Command("help"))
async def cmd_help(message: Message) -> None:
    """–ü–æ–º–æ—â—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é."""
    user_id = message.from_user.id
    is_admin = user_id in settings.ADMIN_IDS
    
    help_text = (
        "‚ÑπÔ∏è <b>–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –±–æ—Ç–∞</b>\n\n"
        f"{get_user_commands()}\n\n"
    )
    
    if is_admin:
        help_text += f"{get_admin_commands()}\n\n"
    
    help_text += (
        "üí° <b>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</b>\n"
        "–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –æ–ø—Ä–æ—Å—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 9:00\n"
        "–∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –∏—Ö –≤ 19:00.\n\n"
        "–î–ª—è —É—á–∞—Å—Ç–∏—è –≤ –æ–ø—Ä–æ—Å–∞—Ö –ø—Ä–æ—Å—Ç–æ –≥–æ–ª–æ—Å—É–π—Ç–µ –≤ –æ–ø—Ä–æ—Å–∞—Ö,\n"
        "–∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –≤–∞—à–∏ –≥—Ä—É–ø–ø—ã."
    )
    
    await message.answer(help_text)


@router.message(Command("my_votes"))
async def cmd_my_votes(message: Message) -> None:
    """–ü–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è /my_votes."""
    await message.answer("üó≥Ô∏è –§—É–Ω–∫—Ü–∏—è /my_votes –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ.")


@router.message(Command("schedule"))
async def cmd_schedule(message: Message) -> None:
    """–ü–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è /schedule."""
    await message.answer("üìÖ –§—É–Ω–∫—Ü–∏—è /schedule –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ.")


